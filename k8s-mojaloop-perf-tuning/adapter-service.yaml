spec:
  replicas: 12
  template:
    spec:
      containers:
        - name: ml-api-adapter-service
          image: mojaloop/ml-api-adapter:$ML_API_TAG
          env:
            - name: LOG_LEVEL
              value: warn
            - name: EVENT_SDK_SIDECAR_DISABLED
              value: '$EVENT_SIDECAR_DISABLED'
            - name: EVENT_SDK_KAFKA
              value: $EVENT_SDK_KAFKA
            - name: EVENT_SDK_TRACE
              value: '$EVENT_SDK_TRACE'
            - name: EVENT_SDK_AUDIT
              value: '$EVENT_SDK_AUDIT'
            - name: EVENT_SDK_LOG
              value: '$EVENT_SDK_LOG'
            - name: MLAPI_KAFKA__PRODUCER__TRANSFER__PREPARE__config__options__sync
              value: 'true'
            - name: MLAPI_KAFKA__PRODUCER__TRANSFER__FULFIL__config__options__sync
              value: 'true'
            - name: MLAPI_KAFKA__PRODUCER__TRANSFER__GET__config__options__sync
              value: 'true'
          livenessProbe:
            initialDelaySeconds: 5
            timeoutSeconds: 2
          readinessProbe:
            initialDelaySeconds: 5
            timeoutSeconds: 1
            periodSeconds: 1
            failureThreshold: 1
          volumeMounts:
            - name: config-override
              mountPath: /opt/app/.EVENT_SDKrc
              subPath: .EVENT_SDKrc
            - name: config-override
              mountPath: /opt/app/.MLAPIrc
              subPath: .MLAPIrc
        - name: ml-api-adapter-service-sidecar
          livenessProbe:
            initialDelaySeconds: 5
          readinessProbe:
            initialDelaySeconds: 5
      volumes:
        - name: config-override
          configMap:
            name: config-override
